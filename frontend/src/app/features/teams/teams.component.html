<div class="teams-container">
  <div class="teams-header">
    <h2>Teams Management</h2>
    <button class="btn btn-primary" (click)="openCreateModal()">+ Create Team</button>
  </div>

  <div *ngIf="isLoading" class="loading">
    <p>Loading teams...</p>
  </div>

  <div *ngIf="!isLoading && teams.length === 0" class="empty-state">
    <p>No teams yet. Create one to get started!</p>
  </div>

  <div *ngIf="!isLoading && teams.length > 0" class="teams-grid">
    <div *ngFor="let team of teams" class="team-card">
      <div class="card-header">
        <h3>{{ team.name }}</h3>
        <div class="card-actions">
          <button class="btn-icon" (click)="openEditModal(team)" title="Edit">âœï¸</button>
          <button class="btn-icon btn-danger" (click)="deleteTeam(team.id)" title="Delete">ğŸ—‘ï¸</button>
        </div>
      </div>
      <div class="card-body">
        <p class="description">{{ team.description || 'No description' }}</p>
        <div class="meta">
          <span>Created: {{ team.createdAt | date: 'MMM d, yyyy' }}</span>
        </div>
      </div>
      <div class="card-footer">
        <button class="btn btn-small" (click)="viewTeamDetails(team)">
          View Details & Members
        </button>
      </div>
    </div>
  </div>

  <!-- Create/Edit Modal -->
  <div *ngIf="showModal" class="modal-overlay" (click)="closeModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ editingTeam ? 'Edit Team' : 'Create New Team' }}</h3>
        <button class="btn-close" (click)="closeModal()">âœ•</button>
      </div>
      <form [formGroup]="teamForm" (ngSubmit)="onSubmit()" class="modal-body">
        <div class="form-group">
          <label for="name">Team Name</label>
          <input
            type="text"
            id="name"
            formControlName="name"
            placeholder="Enter team name"
            class="form-control"
          />
          <small class="error" *ngIf="teamForm.get('name')?.invalid && teamForm.get('name')?.touched">
            Team name is required
          </small>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea
            id="description"
            formControlName="description"
            placeholder="Enter team description"
            class="form-control"
            rows="4"
          ></textarea>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closeModal()">
            Cancel
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="!teamForm.valid">
            {{ editingTeam ? 'Update' : 'Create' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Details Modal -->
  <div *ngIf="selectedTeam" class="modal-overlay" (click)="closeDetailsModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ selectedTeam.name }} - Details</h3>
        <button class="btn-close" (click)="closeDetailsModal()">âœ•</button>
      </div>
      <div class="modal-body">
        <div class="detail-section">
          <h4>Team Information</h4>
          <div class="detail-row">
            <span class="label">Description:</span>
            <span class="value">{{ selectedTeam.description || 'No description' }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Created:</span>
            <span class="value">{{ selectedTeam.createdAt | date: 'medium' }}</span>
          </div>
        </div>

        <div class="detail-section">
          <h4>Team Members</h4>
          <div *ngIf="teamMembers.length === 0" class="empty">
            <p>No members in this team yet</p>
          </div>
          <div *ngIf="teamMembers.length > 0" class="members-list">
            <div *ngFor="let member of teamMembers" class="member-item">
              <div>
                <strong>{{ member.displayName }}</strong>
                <p class="member-email">{{ member.email }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
