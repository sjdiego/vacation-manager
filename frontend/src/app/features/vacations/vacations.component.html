<div class="vacations-container">
  <div class="vacations-header">
    <h2>My Vacations</h2>
    <button class="btn btn-primary" (click)="openCreateModal()">+ Request Vacation</button>
  </div>

  <div *ngIf="isLoading" class="loading">
    <p>Loading vacations...</p>
  </div>

  <div *ngIf="!isLoading && vacations.length === 0" class="empty-state">
    <p>No vacation requests yet. Create one to get started!</p>
  </div>

  <div *ngIf="!isLoading && vacations.length > 0" class="vacations-list">
    <div *ngFor="let vacation of vacations" [ngClass]="['vacation-card', 'status-' + (getStatusName(vacation.status) | lowercase)]">
      <div class="card-header">
        <h3>{{ vacation.startDate | date: 'MMM d, yyyy' }} - {{ vacation.endDate | date: 'MMM d, yyyy' }}</h3>
        <span [ngClass]="['status-badge', 'badge-' + (getStatusName(vacation.status) | lowercase)]">
          {{ getStatusName(vacation.status) }}
        </span>
      </div>
      <div class="card-body">
        <p class="type">{{ getTypeName(vacation.type) }}</p>
        <p class="notes" *ngIf="vacation.notes">{{ vacation.notes }}</p>
      </div>
      <div class="card-footer">
        <button class="btn btn-small" (click)="editVacation(vacation)" *ngIf="getStatusName(vacation.status) === 'Pending'">
          Edit
        </button>
        <button class="btn btn-small btn-danger" (click)="deleteVacation(vacation.id)" *ngIf="getStatusName(vacation.status) === 'Pending'">
          Delete
        </button>
      </div>
    </div>
  </div>

  <!-- Create/Edit Modal -->
  <div *ngIf="showModal" class="modal-overlay" (click)="closeModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ editingVacation ? 'Edit Vacation' : 'Request New Vacation' }}</h3>
        <button class="btn-close" (click)="closeModal()">âœ•</button>
      </div>
      <form [formGroup]="vacationForm" (ngSubmit)="onSubmit()" class="modal-body">
        <div class="form-group">
          <label for="startDate">Start Date</label>
          <input
            type="date"
            id="startDate"
            formControlName="startDate"
            class="form-control"
          />
          <small class="error" *ngIf="vacationForm.get('startDate')?.invalid && vacationForm.get('startDate')?.touched">
            Start date is required
          </small>
        </div>

        <div class="form-group">
          <label for="endDate">End Date</label>
          <input
            type="date"
            id="endDate"
            formControlName="endDate"
            class="form-control"
          />
          <small class="error" *ngIf="vacationForm.get('endDate')?.invalid && vacationForm.get('endDate')?.touched">
            End date is required
          </small>
        </div>

        <div class="form-group">
          <label for="type">Vacation Type</label>
          <select formControlName="type" class="form-control">
            <option value="">Select type</option>
            <option [value]="0">Vacation</option>
            <option [value]="1">Sick Leave</option>
            <option [value]="2">Personal Day</option>
            <option [value]="3">Compensatory Time</option>
            <option [value]="4">Other</option>
          </select>
          <small class="error" *ngIf="vacationForm.get('type')?.invalid && vacationForm.get('type')?.touched">
            Type is required
          </small>
        </div>

        <div class="form-group">
          <label for="notes">Notes (Optional)</label>
          <textarea
            id="notes"
            formControlName="notes"
            placeholder="Add any additional notes"
            class="form-control"
            rows="3"
          ></textarea>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closeModal()">
            Cancel
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="!vacationForm.valid">
            {{ editingVacation ? 'Update' : 'Request' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
